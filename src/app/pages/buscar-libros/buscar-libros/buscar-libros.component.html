<!-- Proyecto: PageMark -->
<!-- Archivo: buscar-libros.component.html -->
<!-- Descripci√≥n: Vista con barra de b√∫squeda y grid de resultados -->
<!-- Autor: Richard Chadwick Plaza - 2¬∫ DAM -->

<div class="p-4">

  <!-- Secci√≥n de libros populares -->
  <app-libros-populares></app-libros-populares>

  <div class="text-center mb-4">
    <h2 class="text-2xl font-bold mb-2">B√∫squeda de libros</h2>
    <p class="text-gray-600">
      Encuentra libros mediante Google Books API introduciendo el t√≠tulo, autor o palabra clave que desees.
    </p>
  </div>

  <!-- Barra de b√∫squeda -->
  <app-search-bar></app-search-bar>

  <!-- Loader de b√∫squeda -->
  <div class="text-center mt-4" *ngIf="buscando">
    <p class="text-blue-500 font-semibold">üîç Buscando libros...</p>
  </div>

  <!-- Mensaje de error -->
  <div class="text-center mt-4" *ngIf="errorBusqueda">
    <p class="text-red-500 font-semibold">‚ùå No se pudo realizar la b√∫squeda. Intenta de nuevo m√°s tarde.</p>
  </div>

  <!-- Por si no hay resultados -->
  <div class="text-center mt-4 text-gray-500" *ngIf="!buscando && libros.length === 0 && !errorBusqueda">
    No se encontraron resultados para tu b√∫squeda.
  </div>
  
  <!-- Resultados de b√∫squeda -->
  <div class="grid mt-4" *ngIf="libros.length > 0">
    <div class="col-12 sm:col-6 md:col-4 lg:col-3 xl:col-2" *ngFor="let libro of libros">
      <mat-card
        class="p-2 h-full shadow-4 cursor-pointer"
        [routerLink]="['/detalles-libro', libro.id]"
      >
          <img
          [src]="libro.volumeInfo.imageLinks?.thumbnail || 'assets/portada-no-encontrada.png'"
          alt="{{ libro.volumeInfo.title || 'Sin t√≠tulo' }}"
          class="w-full border-round mb-2"
          style="height: 300px; object-fit: cover;"
        />
    
        <h4>{{ libro.volumeInfo.title }}</h4>
        <p class="text-sm text-muted">{{ libro.volumeInfo.authors?.join(', ') }}</p>
      </mat-card>
    </div>
  </div>

  <!-- Loader de b√∫squeda solo aparece debajo de los libros -->
  <mat-progress-spinner *ngIf="buscando" mode="indeterminate" diameter="30" color="accent"></mat-progress-spinner>

  
  <!-- Bot√≥n para ver m√°s libros o mensaje si no hay m√°s -->
<div class="text-center mt-4" *ngIf="libros.length > 0 && !buscando && !errorBusqueda">
  <button *ngIf="!noHayMasResultados" mat-raised-button color="primary" (click)="buscarMasLibros()">Ver m√°s</button>

  <p *ngIf="noHayMasResultados" class="text-gray-500 mt-2">
    üìö No hay m√°s resultados para mostrar.
  </p>
</div>

</div>
